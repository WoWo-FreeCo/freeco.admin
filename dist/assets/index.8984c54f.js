import{y as D,k as n,ay as R,C as w,o as _,b as I,w as r,p as o,q as t,ba as O,D as E,b7 as F,z as U,bx as L,by as z}from"./index.3e6756d9.js";import{P as x,a as A,b as B}from"./requestURL.e8351c03.js";import{u as j}from"./prodStore.435d1c3c.js";import{a as u,V as G}from"./VRow.f69d03a9.js";import{V as c}from"./VTextField.a98f3cc5.js";import{V as h,a as M}from"./VFileInput.8966585a.js";import{V as C}from"./VBtn.a3be8285.js";import{V as H}from"./VForm.c2441981.js";import"./axios.364130a5.js";import"./index.9410a6e6.js";import"./forwardRefs.54bb1675.js";import"./VList.ce2db9d6.js";import"./scopeId.92fb2811.js";import"./VMenu.a331d1d3.js";import"./VChip.be86f220.js";const J={__name:"index",setup(K){const f="https://api.wowo.tw",k=n(),N=j(),d=n(),V=n(),v=n(!0),m=n(""),b=n({}),y={skuId:"",categoryName:"",name:"",price:0,memberPrice:0,vipPrice:0,svipPrice:0,attribute:"\u4E00\u822C"},l=n(y),S=["\u4E00\u822C","\u51B7\u93C8"],g=n({}),P=n([]);R(async()=>{var s,e;try{const a=await N.fetchProductCategory(),i=[];(e=(s=a.data)==null?void 0:s.data)==null||e.forEach(p=>{i.push(p.name)}),P.value=i,g.value=a.data.data}catch{console.log("error")}}),w(d,async s=>{v.value=!d.value[0];try{const e=new FormData;e.append("image",d.value[0]);const i=await(await fetch(`${f}/${x}`,{method:"POST",body:e})).json();console.log("\u5716\u7247 response: ",i),m.value=`${f}/${i.filenames[0]}`}catch(e){console.log(e)}}),w(V,async s=>{v.value=!0;try{const e=new FormData;V.value.forEach(p=>{e.append("image",p)}),console.log(V.value);const i=await(await fetch(`${f}/${x}`,{method:"POST",body:e})).json();console.log("\u5716\u7247 response: ",i),b.value=i.filenames.map(p=>({url:`${f}/${p}`})),console.log(b.value)}catch(e){console.log(e)}v.value=!1});async function q(){try{if(!l.value.attribute)return alert("\u8ACB\u9078\u64C7\u5546\u54C1\u904B\u9001\u985E\u578B");if(!l.value.skuId)return alert("\u8ACB\u8F38\u5165\u5546\u54C1\u6A19\u7C64");if(!l.value.categoryName)return alert("\u8ACB\u9078\u64C7\u5546\u54C1\u5206\u985E");const s={...l.value,attribute:l.value.attribute==="\u51B7\u93C8"?"COLD_CHAIN":"GENERAL",categoryId:g.value.find(a=>a.name===l.value.categoryName).id,coverImagePath:m.value};delete s.categoryName,m.value||delete s.coverImagePath;const e=await A.post(`/${B}`,s);alert("\u5DF2\u5EFA\u7ACB\u5546\u54C1"),z.push({path:"/apps/product/list"})}catch(s){console.log(s)}}function T(){m.value=""}function $(){l.value={...y}}return(s,e)=>(_(),I(H,{ref_key:"form",ref:k,"lazy-validation":"",onSubmit:L(q,["prevent"])},{default:r(()=>[o(G,null,{default:r(()=>[o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:t(l).name,"onUpdate:modelValue":e[0]||(e[0]=a=>t(l).name=a),label:"\u5546\u54C1\u540D\u7A31",required:"",placeholder:"\u5546\u54C1\u540D\u7A31"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:t(l).skuId,"onUpdate:modelValue":e[1]||(e[1]=a=>t(l).skuId=a),label:"\u5546\u54C1\u6A19\u7C64",required:"",placeholder:"\u5546\u54C1\u6A19\u7C64"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:t(l).price,"onUpdate:modelValue":e[2]||(e[2]=a=>t(l).price=a),label:"\u5B9A\u50F9",required:"",min:"0",type:"number",placeholder:"\u5B9A\u50F9"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:t(l).memberPrice,"onUpdate:modelValue":e[3]||(e[3]=a=>t(l).memberPrice=a),label:"\u6703\u54E1\u50F9",required:"",type:"number",min:"0",placeholder:"\u6703\u54E1\u50F9"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:t(l).vipPrice,"onUpdate:modelValue":e[4]||(e[4]=a=>t(l).vipPrice=a),label:"VIP\u50F9",required:"",type:"number",min:"0",placeholder:"VIP\u50F9"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:t(l).svipPrice,"onUpdate:modelValue":e[5]||(e[5]=a=>t(l).svipPrice=a),label:"SVIP\u50F9",required:"",type:"number",min:"0",placeholder:"SVIP\u50F9"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(h,{modelValue:t(l).categoryName,"onUpdate:modelValue":e[6]||(e[6]=a=>t(l).categoryName=a),items:t(P),label:"\u5546\u54C1\u5206\u985E",name:"select-1",require:""},null,8,["modelValue","items"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(h,{modelValue:t(l).attribute,"onUpdate:modelValue":e[7]||(e[7]=a=>t(l).attribute=a),items:S,label:"\u5546\u54C1\u904B\u9001\u985E\u578B",name:"select-2",require:""},null,8,["modelValue"])]),_:1}),o(u,{cols:"12",class:"gap-4"},{default:r(()=>[o(M,{modelValue:t(d),"onUpdate:modelValue":e[8]||(e[8]=a=>O(d)?d.value=a:null),accept:"image/*","show-size":"",counter:"",color:"primary",label:"\u4E0A\u50B3\u5546\u54C1\u7E2E\u5716","onClick:clear":T},null,8,["modelValue"]),t(m)?(_(),I(E,{key:0,width:"200",src:t(m)},null,8,["src"])):F("",!0)]),_:1}),o(u,{cols:"12",class:"d-flex gap-4"},{default:r(()=>[o(C,{type:"submit"},{default:r(()=>[U(" \u5EFA\u7ACB ")]),_:1}),o(C,{color:"secondary",variant:"tonal",onClick:$},{default:r(()=>[U(" \u6E05\u9664 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"]))}},de=D(J,[["__scopeId","data-v-208b210b"]]);export{de as default};
