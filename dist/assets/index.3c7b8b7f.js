import{y as R,k as n,aH as O,C as w,o as _,b as I,w as r,p as o,q as l,ba as h,D as E,b7 as F,z as U,bo as L,bD as z}from"./index.814ba5dc.js";import{P as x,a as A,d as B}from"./requestURL.4ab77af1.js";import{u as j}from"./prodStore.82a1e4b7.js";import{V as u}from"./VCol.64655a44.js";import{V as c}from"./VTextField.4b3881bb.js";import{V as C}from"./VSelect.ad81fac4.js";import{V as G}from"./VFileInput.4bf4cb4a.js";import{V as k}from"./VBtn.15cc7225.js";import{V as H}from"./VRow.116d4872.js";import{V as M}from"./VForm.e0345dcf.js";import"./axios.364130a5.js";import"./index.c82ae7fd.js";import"./forwardRefs.54bb1675.js";import"./VList.3902500a.js";import"./VDivider.4f08e55f.js";import"./scopeId.490f9154.js";import"./VMenu.f86191f5.js";import"./VChip.bd7ca155.js";const J={__name:"index",setup(K){const f="https://api.wowo.tw",N=n(),S=j(),i=n(),V=n(),v=n(!0),d=n(""),b=n({}),g={skuId:"",categoryName:"",name:"",price:0,memberPrice:0,vipPrice:0,svipPrice:0,attribute:"\u4E00\u822C"},t=n(g),q=["\u4E00\u822C","\u51B7\u93C8"],y=n({}),P=n([]);O(async()=>{var s,e;try{const a=await S.fetchProductCategory(),m=[];(e=(s=a.data)==null?void 0:s.data)==null||e.forEach(p=>{m.push(p.name)}),P.value=m,y.value=a.data.data}catch{console.log("error")}}),w(i,async s=>{v.value=!i.value[0];try{const e=new FormData;e.append("image",i.value[0]);const m=await(await fetch(`${f}/${x}`,{method:"POST",body:e})).json();console.log("\u5716\u7247 response: ",m),d.value=`${f}/${m.filenames[0]}`}catch(e){console.log(e)}}),w(V,async s=>{v.value=!0;try{const e=new FormData;V.value.forEach(p=>{e.append("image",p)}),console.log(V.value);const m=await(await fetch(`${f}/${x}`,{method:"POST",body:e})).json();console.log("\u5716\u7247 response: ",m),b.value=m.filenames.map(p=>({url:`${f}/${p}`})),console.log(b.value)}catch(e){console.log(e)}v.value=!1});async function D(){try{if(!t.value.attribute)return alert("\u8ACB\u9078\u64C7\u5546\u54C1\u904B\u9001\u985E\u578B");if(!t.value.skuId)return alert("\u8ACB\u8F38\u5165\u5546\u54C1\u6A19\u865F");if(!t.value.categoryName)return alert("\u8ACB\u9078\u64C7\u5546\u54C1\u5206\u985E");const s={...t.value,attribute:t.value.attribute==="\u51B7\u93C8"?"COLD_CHAIN":"GENERAL",categoryId:y.value.find(a=>a.name===t.value.categoryName).id,coverImagePath:d.value};delete s.categoryName,d.value||delete s.coverImagePath;const e=await A.post(`/${B}`,s);alert("\u5DF2\u5EFA\u7ACB\u5546\u54C1"),z.push({path:"/apps/product/list"})}catch(s){console.log(s)}}function T(){d.value=""}function $(){t.value={...g}}return(s,e)=>(_(),I(M,{ref_key:"form",ref:N,"lazy-validation":"",onSubmit:L(D,["prevent"])},{default:r(()=>[o(H,null,{default:r(()=>[o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:l(t).name,"onUpdate:modelValue":e[0]||(e[0]=a=>l(t).name=a),label:"\u5546\u54C1\u540D\u7A31",required:""},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:l(t).skuId,"onUpdate:modelValue":e[1]||(e[1]=a=>l(t).skuId=a),label:"\u5546\u54C1\u6A19\u865F",required:""},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:l(t).price,"onUpdate:modelValue":e[2]||(e[2]=a=>l(t).price=a),label:"\u5B9A\u50F9",required:"",min:"0",type:"number"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:l(t).memberPrice,"onUpdate:modelValue":e[3]||(e[3]=a=>l(t).memberPrice=a),label:"\u6703\u54E1\u50F9",required:"",type:"number",min:"0"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:l(t).vipPrice,"onUpdate:modelValue":e[4]||(e[4]=a=>l(t).vipPrice=a),label:"VIP\u50F9",required:"",type:"number",min:"0"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(c,{modelValue:l(t).svipPrice,"onUpdate:modelValue":e[5]||(e[5]=a=>l(t).svipPrice=a),label:"SVIP\u50F9",required:"",type:"number",min:"0"},null,8,["modelValue"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(C,{modelValue:l(t).categoryName,"onUpdate:modelValue":e[6]||(e[6]=a=>l(t).categoryName=a),items:l(P),label:"\u5546\u54C1\u5206\u985E",name:"select-1",require:""},null,8,["modelValue","items"])]),_:1}),o(u,{cols:"12"},{default:r(()=>[o(C,{modelValue:l(t).attribute,"onUpdate:modelValue":e[7]||(e[7]=a=>l(t).attribute=a),items:q,label:"\u5546\u54C1\u904B\u9001\u985E\u578B",name:"select-2",require:""},null,8,["modelValue"])]),_:1}),o(u,{cols:"12",class:"gap-4"},{default:r(()=>[o(G,{modelValue:l(i),"onUpdate:modelValue":e[8]||(e[8]=a=>h(i)?i.value=a:null),accept:"image/*","show-size":"",counter:"",color:"primary",label:"\u4E0A\u50B3\u5546\u54C1\u7E2E\u5716","onClick:clear":T},null,8,["modelValue"]),l(d)?(_(),I(E,{key:0,width:"200",src:l(d)},null,8,["src"])):F("",!0)]),_:1}),o(u,{cols:"12",class:"d-flex gap-4"},{default:r(()=>[o(k,{type:"submit"},{default:r(()=>[U(" \u5EFA\u7ACB ")]),_:1}),o(k,{color:"secondary",variant:"tonal",onClick:$},{default:r(()=>[U(" \u6E05\u9664 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"]))}},pe=R(J,[["__scopeId","data-v-9cc84402"]]);export{pe as default};
